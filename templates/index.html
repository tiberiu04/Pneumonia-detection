<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Pneumonia Detector</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="{{ url_for('static', filename='css/styles.css') }}" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
</head>
<body>

<div class="bg-image"></div>

<!-- istoric Ã®n stÃ¢nga -->
<div class="prediction-history position-fixed top-50 start-0 translate-middle-y p-2">
  <div class="card shadow" style="background-color: rgba(255,255,255,0.85); width: 220px; max-height: 400px; overflow-y: auto;">
    <div class="card-header text-center fw-bold"
        style="position: sticky; top: 0; background-color: rgba(255,255,255,0.95); z-index: 1; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
    Prediction History
    </div>


    <ul id="history" class="list-group list-group-flush"></ul>
  </div>
</div>


<!-- conÈ›inutul centrat -->
<div class="content d-flex flex-column justify-content-center align-items-center text-white text-center">
  <h1 class="display-3 fw-bold">ðŸ©º Pneumonia Detector</h1>
  <p class="lead">Radiologist-level Pneumonia Detection from Chest X-rays</p>

  <form action="/" method="POST" enctype="multipart/form-data" class="card p-4 mt-4" style="width: 350px; background-color: rgba(255,255,255,0.9);">
    <h5 class="mb-3">Upload X-ray Image</h5>
    <input type="file" name="image" class="form-control mb-3" required>
    <button type="submit" class="btn btn-primary w-100">Detect</button>

    {% if uploaded_image %}
    <div class="mt-3">
        <img src="{{ url_for('static', filename='uploads/' + uploaded_image.split('/')[-1]) }}" 
            alt="Uploaded X-ray" 
            class="img-fluid animate__animated animate__fadeIn mt-3" 
            style="max-width: 100%;">
    </div>
    {% endif %}

    {% if result %}
        <div class="alert alert-info mt-3 fs-4 fw-bold animate__animated animate__pulse animate__infinite">
        {{ result }}
        </div>
    {% endif %}

  </form>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const hist = document.getElementById('history');

  // Ã®ncarcÄƒ istoricul salvat
  const saved = JSON.parse(localStorage.getItem('history') || '[]');
  saved.forEach(text => {
    const li = document.createElement('li');
    li.textContent = text;
    li.classList.add('list-group-item');
    hist.appendChild(li);
  });

  // adaugÄƒ predicÈ›ia curentÄƒ
  const resultDiv = document.querySelector('.alert-info');
  if (resultDiv) {
    const text = resultDiv.textContent.trim();
    const item = document.createElement('li');
    item.textContent = text;
    item.classList.add('list-group-item');
    hist.appendChild(item);

    saved.push(text);
    localStorage.setItem('history', JSON.stringify(saved));
  }
});
</script>

</body>
</html>
